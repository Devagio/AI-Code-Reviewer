{% extends "base.html" %}
{% block content %}
    <form id="review-form" method="post" action="/review">
        <label for="repo_url">GitHub Repository URL:</label><br>
        <input type="url" id="repo_url" name="repo_url" placeholder="https://github.com/user/repo" required style="width: 320px;"><br><br>

        <label for="gh_token">
            GitHub Access Token:
            <a href="https://github.com/settings/tokens" target="_blank" style="font-size: 0.95em;">(Get token)</a>
            <span class="tooltip-i" tabindex="0">
                <b>i</b>
                <span class="tooltip-text">
                    How to get your GitHub Access Token:<br>
                    1. Paste your GitHub repository URL above.<br>
                    2. Click the "Get token" link here<br>
                    3. Click “Generate new token”<br>
                    4. Select the first option ("fine-grain...")<br>
                    5. Fill your GitHub Password if prompted to.<br>
                    6. Enter any random token name and generate token.<br>
                </span>
            </span>
        </label>
        <br>
        <input type="password" id="gh_token" name="gh_token" placeholder="Paste your token here" style="width: 320px;" required><br>
        <small>
            <i>We don’t store your token. It is only used temporarily to fetch your repo and is discarded after processing.</i>
        </small><br><br>

        <button type="submit">Review</button>
    </form>

    <!-- Loading GIF (hidden by default) -->
    <div id="loading" style="display: none; text-align: center; margin-top: 2em;">
        <img src="/static/files/mrbean.gif"
            alt="Loading..." 
            style="max-width: 260px; border-radius: 8px; box-shadow: 0 4px 16px #8882;"
        >
        <div style="margin-top: 1em; font-size: 1.1em;">
            <b>Review in progress...</b><br>
            This can take upto 2 minutes. Please be patient!
        </div>
    </div>

    <script>
      const form = document.getElementById('review-form');
      const loading = document.getElementById('loading');
      form.addEventListener('submit', function() {
          // Show loading GIF
          loading.style.display = 'block';
          // Optionally, hide the form so it can't be re-submitted
          form.style.display = 'none';
      });
    </script>
    
{% endblock %}
